# /work — 自律成長セッション

デジタルアイデンティティのプロフェッショナルとして、今日の知識をアウトプットする。
このコマンドを実行するたびに、最新動向を調査し、思考を記録していく。

> プロジェクトの構造・コマンド・ワークフローは `CLAUDE.md` に記載されている。

## 実行フロー

### Step 1: 現状把握とカバレッジ分析

以下を**並列で** Glob し、ファイル名（スラグ）だけでカバー済みトピックを把握する。**ファイルの Read は行わない**：

- `docs/articles/` のファイル一覧
- `docs/specs/` のファイル一覧

取得したファイル一覧を以下の **カバレッジマトリクス** に照合し、手薄な領域を特定する：

| 領域 | 目安 |
|------|------|
| **仕様・標準** | 主要仕様（OAuth/OIDC/VC/FIDO/mDL）の Spec 記事が揃っているか |
| **エコシステム** | 各地域（EU・日本・米国）・各プラットフォームの動向を追えているか |
| **エンタープライズ ID** | SSF/CAEP・IPSIE・Provider Commands 等の実装動向をカバーしているか |
| **セキュリティ** | NHI/WIMSE・フィッシング耐性・ATO 等の攻防トレンドを追えているか |
| **プライバシー技術** | ZKP・選択的開示・PET の実用化動向をカバーしているか |
| **規制・ガバナンス** | eIDAS 2.0・NIST 800-63-4・国内法改正を追えているか |

**トピック選定は手薄な領域を優先する。** 全領域が均等にカバーされている場合は、最新ニュースや業界変化の大きいトピックを選ぶ。

### Step 2: トピック選定とリサーチ

カバレッジ分析の結果を踏まえ、以下の候補リストから **今日フォーカスするトピックを1つ選び**、WebSearch で最新情報を収集する。
手薄な領域のトピックを優先し、既存コンテンツと重複しないテーマを選ぶこと。

> **必須 — コンテキスト節約**: WebSearch・情報収集は必ず Task ツール（`subagent_type=general-purpose`）でサブエージェントに委託する。
>
> **サブエージェントへの指示ルール（トークン節約の要）**:
> 1. **モデル指定**: サブエージェントは `model: "haiku"` を指定する（WebSearch + 要約は軽量モデルで十分）
> 2. 調査観点は **5項目以内** に絞る（多いほどエージェント出力が肥大化する）
> 3. 出力制限は記事種別で変動させる:
>    - **Article**: 「**最終回答のみ返すこと。プレーンテキストの箇条書きで600文字以内にまとめること。表・コードブロック・URLリストは不要**」
>    - **Spec**: 「**最終回答のみ返すこと。プレーンテキストの箇条書きで1200文字以内にまとめること。仕様の正式名称・ステータス・主要著者・プロトコルフローの要点・セキュリティ要件を含めること。表・コードブロックは不要だが、参照すべき公式 URL は最大3件まで含めてよい**」
> 4. サブエージェントの完了通知（`status: completed`）を受け取るまで **執筆（Write/Edit）を開始しない**。途中で出力ファイルを読んで先行執筆すると研究結果との乖離が生じ、追加コミットが必要になる
> 5. Step 1 と並列でOKな作業: 既存 Spec/Article ファイルの Read（フォーマット確認等）。ただしテンプレートはこのコマンドに完全記載済みのため **既存コンテンツの全文 Read は原則不要**

#### トピック候補

> **重複判定**: Step 1 で取得したファイル一覧と照合し、既にカバー済みのトピックは自動的にスキップする。このリストに「済み」注釈は付けない。

**仕様・標準**

- OpenID4VP 1.0 Final——Spec 記事として体系的に解説（フロー全体・クライアント認証・JAR/JARM・wallet_nonce 等）
- OpenID4VCI 1.0 Final——credential issuance フロー・Wallet Attestation の詳細（Spec 記事）
- OpenID Federation 1.0——トラストチェーン・Subordinate Statement・Entity Configuration の詳細（Spec 記事）
- FAPI 2.0 Security Profile 2.0——Authorization Code Flow + PAR + DPoP の組み合わせ・実装プロファイルとしての要件定義（Spec 記事）
- W3C Verifiable Credentials Data Model 2.0
- SD-JWT VC（RFC 9901）——フォーマット詳細・HAIP での採用・mdoc との比較（Spec 記事）
- WebAuthn Level 3 / CTAP 2.2 の標準化進捗（Spec 記事）
- FIDO CXP/CXF——正式標準化後のエコシステム展開
- Digital Credentials API——RP 実装課題・OpenID4VP 組み合わせの実装詳細
- Android Credential Manager API——プラットフォームレベルのクレデンシャル管理と DC API の関係

**エコシステム**

- EU EUDI Wallet 実装ロードマップ・各国状況
- mDL (ISO 18013-5) の導入事例・技術詳細
- Passkeys / FIDO2 の普及状況・最新統計
- Apple / Google / Microsoft のデジタルウォレット戦略
- 日本のデジタルID動向（マイナンバーカード活用、行政API、民間連携）
- JPKI × OpenID4VP 連携——次期マイナンバーカード（2028年）での ECDSA 対応・Digital Credentials API 連携の可能性・国際標準との整合性
- 日本のデジタルID法制度——マイナンバー法改正・犯罪収益移転防止法 2027年施行・eKYC ワ方式廃止の業界インパクト
- 日本金融業界のパスキー必須化——証券口座乗っ取り事件と業界対応

**エンタープライズ ID セキュリティ**

- IPSIE（Interoperability Profile for Secure Identity in the Enterprise）——OpenID Foundation WG 進捗・相互運用テストイベント
- Shared Signals Framework (SSF) / CAEP——エンタープライズ向け継続的アクセス評価の実装詳細
- OpenID Provider Commands——IdP からアプリへの強制セッション終了コマンドプロトコル

**セキュリティ**

- AI エージェント・NHI の次フェーズ——委譲チェーン管理・Agentic JWT・agent-sd-jwt ドラフトの動向
- IETF WIMSE WG——ワークロードアイデンティティの国際標準化（draft-ietf-wimse-s2s-protocol / identifier の進捗）
- DeepFake・AI生成攻撃と IAL の関係
- フィッシング耐性認証 (FIDO2, passkeys) の最新事例
- Account Takeover トレンドと対策

**プライバシー技術**

- Zero Knowledge Proof の実用化事例——Google Longfellow ZK・Groth16 の DC API 上での動向
- 選択的開示 (Selective Disclosure) の仕様比較
- Privacy-Enhancing Technologies (PET) の動向

**規制・ガバナンス**

- eIDAS 2.0 実施状況と各国対応——EU EUDI Wallet の法的義務化（2026年12月）と各国実装ロードマップ
- NIST SP 800-63-4 最終版（2025年7月31日）——DIRM・PAD 必須化・mDL/VC 受け入れ・実装インパクト
- FIDO Alliance Passkey Index——採用統計と分析
- OpenWallet Foundation ライブラリ群——DCQL TypeScript・OpenID4VC TS・OpenID Federation TS の採用状況と DIDComm への展開
- DIF Presentation Exchange の現状——DCQL 移行後の PE の位置づけ・既存実装への影響・残存する使われ方

### Step 3: コンテンツ形式の選択

以下の基準で形式を**自律的に選択**する（頻度制限なし）：

| 形式 | 選択基準 |
|------|---------|
| **Spec** (`docs/specs/<id>.md`) | 特定の RFC・標準仕様を中心とし、`docs/specs/` に該当ファイルが未存在。体系的整理で高い参照価値が出る場合 |
| **Article** (`docs/articles/YYYY-MM-DD-<slug>.md`) | ニュース反応・考察・比較分析・長期トレンド解説。最新動向から深い技術解説まで幅広く対応 |

今日の日付はシステムコンテキスト（`currentDate`）で確認してから、正しいファイル名を付けること。

> テンプレートは Step 4 に完全記載済み。既存の Spec/Article ファイルを Read してフォーマット確認する必要はない。

### Step 4: コンテンツ執筆

**Spec のファイル命名規則は `CLAUDE.md` を参照。**

**記事のテンプレート**:

```markdown
# [タイトル]

> [一言サマリー]

## はじめに

[この記事が何を論じるか。読者が得られる価値。]

## [セクション1: 背景・問題提起]

[...]

## [セクション2: 技術分析・比較]

[...]

## [セクション3: 実装・事例]

[...]

## まとめと展望

[結論・今後の方向性・読者へのアクション提案。]

## 参考

- [リンクテキスト](URL)
```

**仕様書解説のテンプレート**:

```markdown
# [仕様名] — [正式タイトル]

> **発行**: [発行機関] / [発行年月] / **ステータス**: [標準の状態]
> **著者**: [主要著者] / **更新**: [主要な更新 RFC/仕様]

---

## 概要

[仕様が何を定義するか、なぜ存在するかを3〜5文で説明する。]

---

## 背景：なぜこの仕様が必要だったか

[この仕様が解決した問題・設計の動機。]

---

## 基本概念

[仕様を理解するために必要な用語・ロール・データ構造の定義。]

---

## [主要なフロー/プロトコル詳細]

[シーケンス図（ASCII）やリクエスト/レスポンス例を含める。]

---

## セキュリティ上の重要な考慮事項

[仕様が定義するセキュリティ要件・既知の脅威と対策。]

---

## 後継・関連仕様

[この仕様を拡張・補完・置き換える仕様の一覧表。]

---

## 実装状況・採用

[主要な実装例・採用サービス・エコシステムの現状。]

---

## 読み解きのポイント

[仕様を読む際に見落としやすい設計判断・誤解されやすいポイント。]

---

## 参考

- [正式仕様書](URL)
- [関連 RFC/仕様](URL)
```

**執筆基準**:

- **日本語**で書く（技術用語・固有名詞・仕様名は英語のまま可）
- **自分の視点・考察**を必ず入れる（要約サイトではなく、プロとしての解釈）
- **一次情報**へリンクする（仕様書・RFC・公式ブログ・学術論文を優先）
- **具体性**を重視する（抽象論より実装例・数字・タイムラインを含める）

### Step 5: 振り返りと自己改善（必須）

**このステップは毎回必ず実行する。** スキップは許可しない。

#### 5a: セッション振り返り（必須）

今回の実行を以下の観点で評価し、結果をこのファイル末尾の **セッションログ** セクションに1行追記する：

- **トピック**: 何を書いたか（ファイル名）
- **カバレッジ**: どの領域を埋めたか
- **課題**: リサーチで困った点・情報が不足した点・次回への申し送り

記録フォーマット: `- YYYY-MM-DD: [領域] <ファイル名> — <課題・申し送り（なければ「特になし」）>`

#### 5b: プロセス改善（該当時のみ）

振り返りの結果、以下に該当する場合のみ対象ファイルを Read → Edit する：

**トピックリスト更新**

- 今回のリサーチで、候補リストにまだ載っていない重要トピックを発見した
- 古くなった・旬を過ぎたトピックがある

**実行プロセスの改善**

- 手順が不明瞭で迷った箇所があった
- より良い執筆フロー・調査方法を発見した

**`CLAUDE.md` の更新**

- プロジェクト構造やワークフローに変更があった

### Step 6: コミットとプッシュ

**コミットは1回にまとめる**（記事執筆・自己改善・トピックリスト更新をすべて完了してからまとめてステージング）。途中でコミットすると後から追加コミットが必要になり、履歴が散らかる。

```bash
# ステージング（変更したファイルのみ個別に指定）
git add docs/articles/<filename>.md       # 新規記事
git add docs/specs/<filename>.md          # 新規仕様書解説
git add .claude/commands/work.md          # コマンドを更新した場合
git add CLAUDE.md                         # CLAUDE.md を更新した場合

# コミット（日本語メッセージ推奨）
git commit -m "Add article: [タイトル]"
git commit -m "Add spec: [仕様名] — [正式タイトル]"
# 複数更新の場合：
git commit -m "Add spec: [仕様名] + /work コマンド改善"

# プッシュ（現在のブランチへ）
git push -u origin HEAD
```

---

*このコマンドは毎回実行するたびに新しいコンテンツを生み出し、自らも進化する。
`main` ブランチ上で実行すれば、GitHub Actions 経由で自動デプロイされる。*

---

## セッションログ

> Step 5a で毎回1行追記する。セッション間の学習蓄積と知識ギャップの可視化に使用する。
